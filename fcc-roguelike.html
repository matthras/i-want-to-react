
<head>
    <style>
        .rect0 {
            stroke: white;
            stroke-width: 1px;
        }

        .rectF {
            fill: green;
            stroke: white;
            stroke-width: 1px;
        }

        .rectP {
            fill: purple;
            stroke: white;
            stroke-width: 1px;
        }

        #wallAlert {
            display: none;
        }
    </style>
</head>
<body>
	<div id="root"></div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.18.1/babel.min.js"></script>
	<script type="text/babel">

    class App extends React.Component {
        constructor(props) {
            super(props)
            // Initial conditions
            this.state = {
                health: 5,
                level: 1,
                weapon: "sword1",
                // F = finish position
                // P = player position
                map: [[0,0,0,0,"F"],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],["P",0,0,0,0]],
                // Note: [0,0] is the top left, in line with array coordinates;
                // When accessing elements of this array, need to refer to Y value first, then X value.
                playerLocationX: 0,
                playerLocationY: 4
            }
            this.move = this.move.bind(this);
            this.collisionCheck = this.collisionCheck.bind(this);
        }
        componentWillMount() {
            document.addEventListener("keydown",this.move, false)
        }
        collisionCheck(newCoord) {
            if(newCoord < 0 || newCoord > 4) {
                document.getElementById('wallAlert').style.display= 'block';
                return false;
                // And maybe an alert? "Stop hitting the wall, dude."
            } else {
                document.getElementById('wallAlert').style.display= 'none';
                return true;
            }
        }
        move(event) {
            // Left 
            if(event.keyCode == 37 && this.collisionCheck(this.state.playerLocationX-1)){
                var copyMap = this.state.map;
                copyMap[this.state.playerLocationY][this.state.playerLocationX] = 0;
                copyMap[this.state.playerLocationY][this.state.playerLocationX-1] = "P";
                this.setState({ playerLocationX: this.state.playerLocationX-1, map: copyMap})
            }
            // Right
            if(event.keyCode == 39 && this.collisionCheck(this.state.playerLocationX+1)){
                var copyMap = this.state.map;
                copyMap[this.state.playerLocationY][this.state.playerLocationX] = 0;
                copyMap[this.state.playerLocationY][this.state.playerLocationX+1] = "P";
                this.setState({ playerLocationX: this.state.playerLocationX+1, map: copyMap})
            }
            // Up
            if(event.keyCode == 38 && this.collisionCheck(this.state.playerLocationY-1)){
                var copyMap = this.state.map;
                copyMap[this.state.playerLocationY][this.state.playerLocationX] = 0;
                copyMap[this.state.playerLocationY-1][this.state.playerLocationX] = "P";
                this.setState({ playerLocationY: this.state.playerLocationY-1, map: copyMap})
            }
            // Down
            if(event.keyCode == 40 && this.collisionCheck(this.state.playerLocationY+1)){
                var copyMap = this.state.map;
                copyMap[this.state.playerLocationY][this.state.playerLocationX] = 0;
                copyMap[this.state.playerLocationY+1][this.state.playerLocationX] = "P";
                this.setState({ playerLocationY: this.state.playerLocationY+1, map: copyMap})
            }
        }

        render() {
            return(
                <div id="box">
                    <Map grid={this.state.map} />
                    <span id="wallAlert">Oi dingus, stop hitting the wall!</span>
                </div>
            )
        }
    }

    var Map = React.createClass({
		render: function() {
			var rows = this.props.grid.map( function(i, index) {
					return(
							<Tiles row={i} rowIndex={index} />
						)
				});
			var viewbox = "0 0 "+this.props.width+" 500"
		return (
			<svg width="100" height="100" viewBox="0 0 100 100">
				{rows}
			</svg>
		)
	}
	})

    var Tiles = React.createClass({
		render: function() {
			var dots = this.props.row.map( function(j,index) {
				return (
					<rect x={index*10} width="10" height="10" className={"rect"+j} />
				);
			})
		return (
			<g transform={"translate(0," + this.props.rowIndex*10 + ")"}>
				{dots}
			</g>
			)
		}
	})


    ReactDOM.render(
        <App />,
        document.getElementById('root')
    )

	</script>
</body>